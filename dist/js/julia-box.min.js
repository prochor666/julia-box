var JuliaBoxItem=function(e){var n=this;e="undefined"==typeof e?{}:e;var t=Math.floor(1e7*Math.random()+1);return n.options={autoplay:!1,autoplayControls:!1,attr:"href",collection:$("a[data-julia-box] img"),debug:!1,i18n:{close:"Close",next:"Next",previous:"Previous",errorIframe:"Error, content not loaded",errorImage:"Error, image not loaded",errorInline:"Error, element not found"},iframeWidthLimit:1280,item:{},itemIndex:0,onClose:!1,onInit:!1,onNext:!1,onPrevious:!1,overlayActive:!0,root:$("body"),sources:{},thumbs:!1,timeout:7,videoAutoplay:!0},$.extend(!0,n.options,e),n.env={attr:n.options.attr,autoplay:n.options.autoplay,autoplayControls:n.options.autoplayControls,collection:n.options.collection,i18n:n.options.i18n,ID:t,iframeWidthLimit:n.options.iframeWidthLimit,initiator:!1,instance:{},item:n.options.item,itemIndex:n.options.itemIndex,itemType:"inline",last:n.options.collection.length-1,mediaObj:$([]),mediaObjSize:[0,0],model:{wrapper:{},content:{},toolbar:{},buttons:{},panels:{},preloader:{}},overlayActive:n.options.overlayActive,opener:!1,overflow:n.options.root.css("overflow"),root:n.options.root,services:{image:/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i,youtube:/(youtube(-nocookie)?\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?([\w-]{11})(.*)?/i,vimeo:/(vimeo(pro)?\.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/,googleMaps:/((maps|www)\.)?google\.([^\/\?]+)\/?((maps\/?)?\?)(.*)/i,facebookVideo:/(facebook\.com)\/([a-z0-9_-]*)\/videos\/([0-9]*)(.*)?$/i,instagram:/(instagram\.com)\/p\/([^\/]+)\/(\?\S*)?$/i,iframe:/(http|https)?:\/\/[a-zA-Z0-9-\.]+\.[a-z]{2,4}/i},timeout:n.options.timeout,timer:!1,videoAutoplay:n.options.videoAutoplay},n.Base={},n.Base.debug=function(e){if(n.options.debug===!0&&window.console)for(d in e)console.log(" - [Julia BOX instance: "+n.env.ID+"] "+d+" ["+typeof e[d]+"]",e[d])},n.options.debug===!0&&window.console&&console.info("=== Julia BOX console debug start, instance "+n.env.ID+" ==="),n.Ui=new n._Ui(n),n.Events=new n._Events(n),n.Callback=new n._Callback(n),n.Support=new n._Support(n),n.Media=new n._Media(n),n.Controls=new n._Controls(n),n.Persist=new n._Persist(n),n.Fullscreen=new n._Fullscreen(n),n.Events.init(),publicApi={ID:n.env.ID,Controls:n.Controls,env:n.env},publicApi},JuliaBox=function(e){e="undefined"==typeof e?{}:e;var n={sources:{},attr:"href",root:$("body")},t=Math.floor(1e7*Math.random()+1);$.extend(!0,n,e);var i=function(e){var n=function(e){return!!(e instanceof jQuery&&e.length||e instanceof HTMLElement)};if(e instanceof HTMLCollection&&e.length){for(var t=0,i=e.length;t<i;t++)if(!n(e[t]))return!1;return!0}return n(e)},o=function(e){var t=$("<a />");return"string"==typeof e&&t.attr(n.attr,e),"object"!=typeof e||i(e)||(e.hasOwnProperty("href")?t.attr(n.attr,e.href):e.hasOwnProperty("src")&&t.attr(n.attr,e.src),e.hasOwnProperty("title")?t.attr("title",e.title):t.attr("title","")),t.css({display:"none"}),t};_collection=$('<div class="---julia-virtual-gallery-'+t+'---" style="display: none;" />');for(index in n.sources)_item=o(n.sources[index]),_collection.append(_item);return n.root.append(_collection),result=_collection.find("a").juliaBox(n),result};JuliaBoxItem.prototype._Ui=function(e){var n=this;n.create=function(){e.env.instance.lemgth>0&&e.env.instance.remove(),e.env.instance=$('<div class="julia-box julia-fullscreen-off" id="julia-box-'+e.env.ID+'"></div>'),e.env.model.wrapper=$('<div class="julia-wrapper" id="julia-wrapper-'+e.env.ID+'"></div>'),e.env.model.content=$('<div class="julia-content" id="julia-content-'+e.env.ID+'"></div>'),e.env.model.toolbar=$('<div class="julia-toolbar" id="julia-toolbar-'+e.env.ID+'"></div>'),e.env.model.preloader=$('<div class="julia-preloader on"></div>'),e.env.model.buttons.play=$('<button class="julia-btn julia-playback play">    <i class="julia-icon julia-play"></i></button>'),e.env.model.buttons.next=$('<button class="julia-btn julia-next" title="'+e.env.i18n.next+'">    <i class="julia-icon julia-chevron-right"></i></button>'),e.env.model.buttons.previous=$('<button class="julia-btn julia-previous" title="'+e.env.i18n.previous+'">    <i class="julia-icon julia-chevron-left"></i></button>'),e.env.model.buttons.close=$('<button class="julia-btn julia-close" title="'+e.env.i18n.close+'">    <i class="julia-icon julia-close"></i></button>'),e.env.model.buttons.fullscreen=$('<button class="julia-btn julia-fullscreen-toggle">    <i class="julia-icon julia-fullscreen-on"></i></button>'),e.env.model.panels.fileName=$('<div class="julia-panel julia-file-name">    <span>{{file-name}}</span></div>'),e.env.model.panels.fileDescription=$('<div class="julia-panel julia-file-description">    <span>{{file-description}}</span></div>'),e.env.model.panels.summary=$('<div class="julia-panel julia-summary">    <span>{{summary}}</span></div>'),e.env.model.content.append([e.env.model.preloader]),e.env.last>0&&e.env.model.toolbar.append([e.env.model.buttons.previous,e.env.model.buttons.next]),e.env.model.toolbar.append([e.env.model.buttons.close]),e.env.model.wrapper.append([e.env.model.toolbar,e.env.model.content]),e.env.instance.append([e.env.model.wrapper]),n.zIndexize(),e.env.root.append(e.env.instance),e.env.fullscreenFrame=document.querySelector("#julia-box-"+e.env.ID),e.Ui.state(e.env.instance,"","on"),n.raiseEvent("julia.ui-ready"),e.Base.debug({boxInstance:e.env.instance})},n.raiseEvent=function(t){setTimeout(function(){1==$("#julia-box-"+e.env.ID).length?$("#julia-box-"+e.env.ID).trigger({type:t}):n.raiseEvent(t)},10)},n.icon=function(e,n,t){e.find("i").removeClass(n).addClass(t)},n.state=function(e,n,t){e.removeClass(n).addClass(t)},n.panel=function(e,n){e.find("span").text(n)},n.zIndexize=function(){var n=0;$("*").each(function(){var e=parseInt($(this).css("z-index"),10);e>n&&(n=e)}),e.Base.debug({"Highest z-index":n}),e.env.instance.css({"z-index":n+1}),e.env.model.content.css({"z-index":n+2}),e.env.model.toolbar.css({"z-index":n+3}),e.env.model.preloader.css({"z-index":n+4})}},JuliaBoxItem.prototype._Callback=function(e){var n=this;n.fn=function(n,t){t=t||{},$.inArray(typeof n,["string","function","object"])>-1?("string"==typeof n&&(n=window[n]),n(e.options,e.env,t),e.Base.debug({Callback:typeof n+" raised"})):e.Base.debug({Callback:typeof n+" is not a function, but: "+typeof n})}},JuliaBoxItem.prototype._Controls=function(e){var n=this;n.press=function(n,t){switch(t=t||{},e.Base.debug({action:n,"action-data":t}),n){case"play":break;case"pause":break;case"next":clearTimeout(e.env.timer),index=e.env.itemIndex+1,index==e.env.collection.length&&(index=0),e.options.onNext!==!1&&e.Callback.fn(e.options.onNext,e.env),e.Events.keysOff(),e.env.instance.remove(),e.env.collection[index].click();break;case"previous":clearTimeout(e.env.timer),index=e.env.itemIndex-1,index==-1&&(index=e.env.collection.length-1),e.options.onPrevious!==!1&&e.Callback.fn(e.options.onPrevious,e.env),e.Events.keysOff(),e.env.instance.remove(),e.env.collection[index].click();break;case"close":clearTimeout(e.env.timer),e.options.onClose!==!1&&e.Callback.fn(e.options.onClose,e.env),e.env.instance.hide(75,function(){e.Events.keysOff(),e.env.instance.remove(),e.env.root.css({overflow:e.env.overflow}),e.env.root.find("[data-julia-box-initiator]").removeData("julia-box-initiator")});break;case"fullscreen-on":break;case"fullscreen-off":}}},JuliaBoxItem.prototype._Support=function(n){var t=this;t.aspect=function(e,n){return e>0&&n>0?n/e:0},t.isMobile=function(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile/i.test(navigator.userAgent)},t.iOS=function(){return!(!/iPad|iPhone|iPod/.test(navigator.userAgent)||window.MSStream)},t.extension=function(){return e=/[.]/.exec(n.env.item.attr(n.env.attr))?/[^.]+$/.exec(n.env.item.attr(n.env.attr)):["","undefined",""],e[0]},t.iframe=function(e,n){return $('<div class="julia-iframe-container julia-box-'+n+'"><iframe frameborder="0" width="100%" height="100%" allowfullscreen src="'+e+'"/></div>')},t.initiator=function(){return l=n.env.root.find("[data-julia-box-initiator]").length,l?l:0},t.isUrlValid=function(e){return e.match("^/")},t.isDOMElement=function(e){var n=function(e){return!!(e instanceof jQuery&&e.length||e instanceof HTMLElement)};if(e instanceof HTMLCollection&&e.length){for(var t=0,i=e.length;t<i;t++)if(!n(e[t]))return!1;return!0}return n(e)}},JuliaBoxItem.prototype._Media=function(e){var n=this;n.mediaService=function(n){for(i in e.env.services)if(e.env.services[i].test(n))return i;return e.Support.isUrlValid(n)?"iframe":"inline"},n.getMedia=function(){var t="inline",i="";switch(void 0!==typeof e.env.item.attr(e.env.attr)&&e.env.item.attr(e.env.attr)!==!1&&(i=e.env.item.attr(e.env.attr),t=n.mediaService(i)),t){case"image":e.env.itemType="image",e.env.mediaObj=$('<img src="'+i+"?_c="+Math.floor(1e7*Math.random()+1)+'" alt="'+i+'">');break;case"youtube":var o=e.env.services[t].exec(i);e.env.itemType="iframe",o&&(iframeSrc="https://www.youtube"+(o[2]||"")+".com/embed/"+o[4],e.env.videoAutoplay===!0&&(iframeSrc+="?autoplay=1"),e.env.mediaObj=e.Support.iframe(iframeSrc,t));break;case"vimeo":var o=e.env.services[t].exec(i);e.env.itemType="iframe",o&&(iframeSrc="https://player.vimeo.com/video/"+o[3],e.env.videoAutoplay===!0&&(iframeSrc+="?autoplay=1"),e.env.mediaObj=e.Support.iframe(iframeSrc,t));break;case"googleMaps":var o=e.env.services[t].exec(i);e.env.itemType="iframe",o&&(iframeSrc="https://www.google."+o[3]+"/maps?"+o[6],iframeSrc+=o[6].indexOf("layer=c")>0?"&amp;output=svembed":"&amp;output=embed",e.env.mediaObj=e.Support.iframe(iframeSrc,t));break;case"instagram":var o=e.env.services[t].exec(i);e.env.itemType="iframe",o&&(iframeSrc="https://www.instagram.com/p/"+o[2]+"/embed/",e.env.mediaObj=e.Support.iframe(iframeSrc,t));break;case"facebookVideo":var o=e.env.services[t].exec(i);e.env.itemType="iframe",o&&(iframeSrc="https://www.facebook.com/plugins/video.php?href="+i,e.env.videoAutoplay===!0&&(iframeSrc+="&autoplay=1&show-captions=1"),e.env.mediaObj=e.Support.iframe(iframeSrc,t));break;case"iframe":var o=e.env.services[t].exec(i);e.env.itemType="iframe",(o||e.Support.isUrlValid(i))&&(iframeSrc=i,e.env.mediaObj=e.Support.iframe(iframeSrc,t));break;default:e.env.itemType="inline",e.Support.isDOMElement($(i))?e.env.mediaObj=$('<div class="julia-inline-container">'+$(i).html()+"</div>"):e.env.mediaObj=$('<div class="julia-inline-container julia-error">'+e.env.i18n.errorInline+"</div>")}e.env.model.content.append(e.env.mediaObj),"inline"===e.env.itemType?(n.resize(),e.Ui.state(e.env.model.preloader,"on",""),e.Ui.state(e.env.mediaObj,"","on")):"image"===e.env.itemType?e.env.mediaObj.on("load error",function(t){"error"!=t.type&&"undefined"!==$(this).width()&&0!==$(this).width()||(e.env.mediaObj=$('<div class="julia-inline-container julia-error">'+e.env.i18n.errorImage+"</div>"),e.env.model.content.html(e.env.mediaObj)),n.resize(),e.Ui.state(e.env.model.preloader,"on",""),e.Ui.state(e.env.mediaObj,"","on")}):(loaderEventHandler=e.env.mediaObj.find("iframe"),loaderEventHandler.on("load error",function(t){"error"==t.type&&(e.env.mediaObj=$('<div class="julia-inline-container julia-error">'+e.env.i18n.errorIframe+"</div>"),e.env.model.content.html(e.env.mediaObj)),n.resize(),e.Ui.state(e.env.model.preloader,"on",""),e.Ui.state(e.env.mediaObj,"","on")}))},n.resize=function(){mediaSize=n.setSize(),e.env.mediaObj.width(mediaSize[0]),e.env.mediaObj.height(mediaSize[1]),e.env.mediaObj.css({"margin-top":(mediaSize[3]-mediaSize[1])/2+"px"}),e.Base.debug({extension:e.Support.extension(),item:e.env.item,itemType:typeof e.env.item,mediaObj:e.env.mediaObj,mediaSize:mediaSize})},n.setSize=function(){var t=$(window).width(),i=$(window).height(),o=e.env.mediaObjSize[0],a=e.env.mediaObjSize[1];return 0!=o&&0!=a||e.env.mediaObj.hasClass("julia-error")||(o="iframe"===e.env.itemType||"inline"===e.env.itemType?1280:e.env.mediaObj.width(),a="iframe"===e.env.itemType||"inline"===e.env.itemType?720:e.env.mediaObj.height(),e.env.mediaObjSize=[o,a]),ta=e.Support.aspect(o,a),o>=t&&(o=t-20,("iframe"===e.env.itemType||"inline"===e.env.itemType)&&o>e.env.iframeWidthLimit&&(o=e.env.iframeWidthLimit),a=o*ta),a>=i-20&&(a=i-10,o=a/ta),mediaService=n.mediaService(e.env.item.attr(e.env.attr)),"instagram"===mediaService&&(o=a-100),o=parseInt(o,10),a=parseInt(a,10),e.Base.debug({window:[t,i],mediaObj:[o,a]}),[o,a,t,i]}},JuliaBoxItem.prototype._Events=function(e){var n=this;n.init=function(){e.env.item.on("click",function(n){n.preventDefault(),0==e.Support.initiator()&&e.env.item.data("julia-box-initiator","True"),e.env.root.css({overflow:"hidden"}),e.Ui.create(),e.Events.ui(),$("#julia-box-"+e.env.ID).on("julia.ui-ready",function(){e.Media.getMedia()}),e.options.onInit!==!1&&e.Callback.fn(e.options.onInit,e.env),e.env.model.buttons.close.focus(),e.env.autoplay===!0&&(e.env.timer=setTimeout(function(){e.Controls.press("next")},1e3*e.env.timeout))})},n.keysOff=function(){e.env.root.off("keydown"),e.env.model.buttons.close.off("click"),e.env.model.buttons.previous.off("click"),e.env.model.buttons.next.off("click")},n.ui=function(){e.env.model.content.on("click",function(n){n.stopPropagation(),$(n.target).is(".julia-content")&&e.options.overlayActive===!0&&e.Controls.press("close")}),e.env.model.buttons.close.on("click",function(n){n.preventDefault(),e.Controls.press("close")}),e.env.model.buttons.previous.on("click",function(n){n.preventDefault(),e.Controls.press("previous")}),e.env.model.buttons.next.on("click",function(n){n.preventDefault(),e.Controls.press("next")}),e.env.root.on("keydown",function(n){27===n.keyCode&&e.Controls.press("close"),37===n.keyCode&&e.Controls.press("previous"),39===n.keyCode&&e.Controls.press("next")});var n,t=!1,i=10,o=function(){new Date-n<i?setTimeout(o,i):(t=!1,e.Media.resize())};$(window).on("resize",function(){n=new Date,t===!1&&(t=!0,setTimeout(o,i))})}},JuliaBoxItem.prototype._Fullscreen=function(e){var n=this;n.on=function(n){n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():e.Base.debug({fullscreen:"Fullscreen is not supported"})},n.off=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},n.reset=function(n,t,i){$(document).off("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange"),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(o){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(e.Ui.state(n,"julia-fullscreen-off","julia-fullscreen-on"),e.Ui.state(t.buttons.fullscreen,"on","off"),e.Ui.icon(t.buttons.fullscreen,"julia-fullscreen","julia-fullscreen-exit"),e.Base.debug({"fullscreen on":"#julia-player-"+e.env.ID})):(e.Ui.state(n,"julia-fullscreen-on","julia-fullscreen-off"),e.Ui.state(t.buttons.fullscreen,"off","on"),e.Ui.icon(t.buttons.fullscreen,"julia-fullscreen-exit","julia-fullscreen"),e.Base.debug({"fullscreen off":"#julia-player-"+e.env.ID})),e.Support.resize(),setTimeout(function(){w=e.env.api.getAttribute("width"),e.env.instance.find(".julia-progress").width(w),e.env.instance.find(".julia-progress .julia-slider-track").width(w),t.sliders.progress.update(e.Timecode.toPercents(i.currentTime))},5)})}},JuliaBoxItem.prototype._Persist=function(e){var n=this;n.set=function(e,n,t){dateObj=new Date,dateObj.setTime(dateObj.getTime()+24*t*60*60*1e3);var i="expires="+dateObj.toUTCString();document.cookie=e+"="+n+"; "+i+"; path=/"},n.get=function(e){for(var e=e+"=",n=document.cookie.split(";"),t=0;t<n.length;t++){for(var i=n[t];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}}},function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(n,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(n)),e(t),t}:e(jQuery)}(function(e){jQuery.fn.juliaBox=function(n){var t=this,i=[];return this.each(function(o){if(!e(this).data("juliabox")){n="undefined"==typeof n?{}:n,n.collection=t,n.item=e(this),n.itemIndex=o;var a=new JuliaBoxItem(n,!0);e(this).data("juliabox",a),i.push(a)}}),i}});